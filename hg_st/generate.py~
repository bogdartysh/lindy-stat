
import os
for l in range(10000, 25000, 1000):
    os.system('hg update ' + str(l))
    os.system("hg annotate * | cut -d':' -f1 | sort | uniq -c  | sed -e 's/^ *//g;s/ *$//g' | tr -s ' ' > ../lindy-stat/$(hg identify --num | tr -s ' ').all.csv ")
stats = {}
for l in range(10000, 25000, 1000):
    stats[l] = {}
    with open('../lindy-stat/' + str(l) + '.all.csv') as ins:
        for line in ins:
            try:
                nums = [int(n) for n in line.split()]
                qty = nums[0]
                key = nums[1]//1000
                if key in stats[l]:
                    stats[l][key] = stats[l][key] + qty
                else:
                    stats[l][key] = qty
            except ValueError:
              pass
print 'when,' + ', '.join(str(x) for x in stats.keys())
for key, val in stats
    print str(key) + ',' + ', '.join(str(x) for x in val.values())

when,10000, 11000, 12000, 13000, 14000, 15000, 16000, 17000, 18000, 19000, 20000, 21000, 22000, 23000, 24000
10000,5444, 11273, 12904, 10403, 10530, 14814, 18392, 40719, 44408, 63786, 10
11000,5299, 9286, 11332, 9986, 10082, 13888, 16767, 39275, 42563, 57595, 28142, 9
12000,4749, 8102, 9656, 7752, 7884, 12166, 14353, 33054, 33869, 40900, 19596, 111913, 20
13000,4177, 6467, 7000, 5076, 5424, 6075, 7982, 21350, 26982, 33689, 13250, 86773, 88982, 10
14000,4068, 6220, 6708, 4926, 5196, 5590, 7719, 19914, 22867, 31894, 11733, 77001, 81644, 41499, 18
15000,3961, 6006, 6367, 4716, 4880, 5322, 7290, 19455, 22110, 29492, 11059, 70076, 78261, 36174, 64247, 9
16000,3925, 5946, 6302, 4679, 4795, 5256, 7100, 18715, 21809, 28617, 10611, 66798, 71522, 33445, 61199, 50078, 1
17000,3863, 5922, 6223, 4591, 4603, 5130, 6739, 18256, 20895, 28369, 10430, 66154, 69816, 32553, 57414, 46805, 29720, 0
18000,3785, 5854, 6167, 4529, 4514, 5009, 6641, 18069, 20811, 27875, 10211, 65638, 68341, 31465, 55820, 44674, 28256, 30000, 3
19000,3774, 5805, 6115, 4295, 4447, 4935, 6408, 17688, 20186, 27741, 10068, 65411, 67585, 31060, 55388, 43947, 27570, 28891, 17935, 2
20000,3751, 5730, 6059, 4104, 4384, 4780, 6220, 17309, 19931, 27326, 9421, 58803, 66763, 30124, 54294, 42752, 26697, 26996, 17229, 27189, 10
21000,3688, 5668, 5956, 3945, 4293, 4701, 5236, 17136, 19358, 26886, 8828, 58459, 65996, 29534, 53834, 41977, 26075, 26367, 16698, 21376, 15935, 10
22000,3678, 5645, 5856, 3889, 4226, 4669, 5112, 17019, 19045, 26472, 8656, 58179, 65677, 28895, 53468, 41245, 25548, 25714, 15933, 20621, 14732, 18425, 2
23000,3648, 5596, 5681, 3833, 4036, 4608, 5040, 16946, 18969, 26407, 8586, 58075, 65316, 28777, 52245, 40478, 25000, 25073, 15505, 20190, 13719, 17952, 16573, 13
24000,3641, 5589, 5670, 3807, 3976, 4577, 5002, 16851, 18915, 26313, 8500, 57951, 64933, 28547, 51679, 39982, 24552, 24735, 15148, 19695, 13332, 17116, 15381, 19315, 4



